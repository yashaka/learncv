from typing import Tuple
from matplotlib import pyplot as plt
import numpy as np


def subset(
    images, labels, number: Tuple[int, int] | int = (2, 5), cmap='gray', vmin=0, vmax=255
):
    rows, cols = (
        number
        if isinstance(number, tuple)
        else ((number // 5, 5) if number % 5 == 0 else (number // 5 + 1, 5))
    )
    for cnt, idx in enumerate(
        np.random.randint(0, len(images), rows * cols if isinstance(number, tuple) else number)
    ):
        plt.subplot(rows, cols, cnt + 1)
        plt.imshow(images[idx], cmap=cmap, vmin=vmin, vmax=vmax)
        plt.title(labels[idx]), plt.axis(False)


def training_history(training, /):
    history = training.history
    epochs = range(len(history['loss']))
    plt.plot(epochs, history['loss'], '.-'), plt.grid(True)
    plt.xlabel('epoch'), plt.ylabel('loss')
